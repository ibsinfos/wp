// source --> http://www.bristolgate.com/wp-content/plugins/dynamic-stock-charts/js/dynamic-stock-charts.min.js?ver=1.1 
/**
 * Dynamic Stock Charts (jQuery plugin)
 * Version 1.2.0, built on Mon Apr 25 2016
 * Copyright WebTheGap <mail@webthegap.com>
 * http://webthegap.com/widgets/dynamic-stock-charts/
 */
!function(t){function e(){t(".dschart").each(function(t,e){a(e)})}function a(e){var a=t(e),r=a.attr("id"),n=a.data("symbol"),o=a.data("start-date"),s=a.data("end-date")?a.data("end-date"):(new Date).format("Y-m-d"),i=p(o,s,v),l=i.length;return""==n?!0:(a.empty(),a.removeData("chart-periods"),a.removeData("chart-data"),0==a.find(".dsc-loader").length&&a.prepend('<div class="active dsc-loader"></div>'),void t.each(i,function(t,e){y(String.format("{0} FROM {1} TO {2}",n,e.start,e.end)),c("yahoo.finance.historicaldata",String.format('symbol = "{0}" and startDate = "{1}" and endDate = "{2}"',n,e.start,e.end),{periodId:t,totalPeriods:l,chartId:r,symbol:n})}))}function r(e){var a={};return t.isArray(e)||(e=[e]),t.each(e,function(t,e){var r=new Date(e.Date),n=r.getTime();a[n]={},a[n].DateString=e.Date,a[n].Date=r,a[n].Open=Math.round(100*parseFloat(e.Open))/100,a[n].High=Math.round(100*parseFloat(e.High))/100,a[n].Low=Math.round(100*parseFloat(e.Low))/100,a[n].Close=Math.round(100*parseFloat(e.Close))/100,a[n].AdjClose=Math.round(100*parseFloat(e.Adj_Close))/100,a[n].Volume=parseInt(e.Volume)}),a}function n(t,e){var a,r,n=t.attr("id"),o=t.data("symbol"),i=t.data("navigation")===!0,l=t.data("zoom")===!0,u=t.data("navigation-days"),c=t.data("width")?t.data("width"):"100%",f=t.data("height"),g=t.data("type"),p=t.data("field"),m=t.data("end-date")?new Date(t.data("end-date")):new Date,D=t.data("indicators")?t.data("indicators"):[],v=D.length,b=[],M=e.length,C=t.data("chart-options"),w=t.data("navigation-options");t.width(c),t.height(f),y("Chart options",C);var T=[];if("CandlestickChart"==g)for(T.push([{type:i||l?"date":"string",label:"Date"},{type:"number",label:"Low"},{type:"number",label:"Open"},{type:"number",label:"Close"},{type:"number",label:"High"},{type:"string",role:"tooltip",p:{html:!0}}]),a=0;M>a;a++)T.push([i||l?e[a].Date:e[a].DateString,e[a].Low,e[a].Open,e[a].Close,e[a].High,d(o,e[a])]);else for(T.push([{type:i||l?"date":"string",label:"Date"},{type:"number",label:p},{type:"string",role:"tooltip",p:{html:!0}}]),a=0;M>a;a++)T.push([i||l?e[a].Date:e[a].DateString,e[a][p],d(o,e[a])]);for(a=0;v>a;a++){for(b=s(D[a],e),r=0;M+1>r;r++)T[r].push(b[r]),0==r?T[r].push({type:"string",role:"tooltip",p:{html:!0}}):T[r].push(h(D[a].title,b[r]));y("indicatorData",b)}var O=google.visualization.arrayToDataTable(T);for(C.series={},a=0;v>a;a++)C.series[a+1]={type:"line",color:D[a].color};if(i){t.append('<div id="'+n+'-chart" style="height: '+(f-80)+'px;"></div>'),t.append('<div id="'+n+'-control" style="height: 80px; margin-top: -20px;"></div>');var F=new google.visualization.Dashboard(document.getElementById(n)),A=new google.visualization.ControlWrapper({controlType:"ChartRangeFilter",containerId:n+"-control",options:w,state:{range:{start:new Date(m.getTime()-864e5*u),end:m}}}),S=new google.visualization.ChartWrapper({chartType:g,containerId:n+"-chart",options:C});F.bind(A,S),F.draw(O)}else{var z;switch(g){case"LineChart":C.seriesType="line";break;case"AreaChart":C.seriesType="area";break;case"CandlestickChart":C.seriesType="candlesticks"}z=new google.visualization.ComboChart(document.getElementById(n)),z.draw(O,C)}}function o(t){return Math.round(100*parseFloat(t))/100}function s(t,e){y("Indicator settings",t);var a,r,n,s=[],u=e.length;if("simpleMovingAverage"==t.type){var d=parseInt(t.numberOfDays);for(a=0;u>a;a++){if(d-1>a)n=null;else{for(n=0,r=d-1;r>=0;r--)n+=e[a-r].AdjClose;n=o(n/d)}s.push(n)}}else if("exponentialMovingAverage"==t.type){var d=parseInt(t.numberOfDays);for(a=0;u>a;a++){if(d-1>a)n=null;else if(a==d-1){for(n=0,r=d-1;r>=0;r--)n+=e[a-r].AdjClose;n=o(n/d)}else n=o((e[a].AdjClose-s[a-1])*(2/(1+d))+s[a-1]);s.push(n)}}else if("weightedMovingAverage"==t.type){var d=parseInt(t.numberOfDays),h=l(d),c=i(h);for(a=0;u>a;a++){if(d-1>a)n=null;else{for(n=0,r=d-1;r>=0;r--)n+=e[a-r].AdjClose*h[r];n=o(n/c)}s.push(n)}}return s.unshift({type:"number",label:t.title}),s}function i(t){for(var e=0,a=t.length,r=0;a>r;r++)e+=t[r];return e}function l(t){result=[];for(var e=t;e>=1;e--)result.push(e);return result}function u(t){var e=[],a=[];for(dateProperty in t)t&&e.push(dateProperty);e=e.sort();for(var r=e.length,n=0;r>n;n++)a.push(t[e[n]]);return a}function d(t,e){return'<table class="dsc-tooltip"><caption>'+t+'</caption><tr><td class="label">Date:</td><td>'+e.DateString+'</td></tr><tr><td class="label">Open:</td><td>'+e.Open+'</td></tr><tr><td class="label">High:</td><td>'+e.High+'</td></tr><tr><td class="label">Low:</td><td>'+e.Low+'</td></tr><tr><td class="label">Close:</td><td>'+e.Close+'</td></tr><tr><td class="label">Adj Close:</td><td>'+e.AdjClose+'</td></tr><tr><td class="label">Volume:</td><td>'+e.Volume+"</td></tr></table>"}function h(t,e){return'<table class="dsc-tooltip"><caption>'+t+'</caption><tr><td class="label">Value:</td><td>'+e+"</td></tr></table>"}function c(e,a,r){t.ajax({url:String.format(m,encodeURIComponent(String.format(D,e,a))),dataType:"json",async:!0,context:r,success:f,error:g})}function f(e,a,o){var s=null,i=this.chartId.replace(/(:|\^|\.|\[|\]|,|=)/g,"\\$1"),l=(this.periodId,this.totalPeriods),d=t("#"+i),h=d.data("symbol");if("undefined"!=typeof e.query.results&&e.query.count>0){s=r(e.query.results[Object.keys(e.query.results)[0]]);var c=d.data("chart-periods")?parseInt(d.data("chart-periods")):0,f=d.data("chart-data")?d.data("chart-data"):{};t.extend(f,s),d.data("chart-periods",++c),d.data("chart-data",f),c==l&&(f=u(f),y("Data for "+h,f),n(d,f))}else y("No data for "+h,e),d.append('<div class="dsc-err-message">Ooops, no data is provided by Yahoo Finance API for '+h+". Try something else.</div>");d.find(".dsc-loader").removeClass("active")}function g(t,e,a){y("smYqlQueryError",e+"|"+a)}function p(t,e,a){for(var r=[],n=new Date(e),o=new Date(e),t=new Date(t);n.getTime()-1e3*a*3600*24>t.getTime();)o.setDate(n.getDate()-a),r.push({start:o.format("Y-m-d"),end:n.format("Y-m-d")}),n.setDate(n.getDate()-a-1);return r.push({start:t.format("Y-m-d"),end:n.format("Y-m-d")}),r}function y(t,e){b&&("undefined"!=typeof e?console.log(t,e):console.log(t))}google.load("visualization","1",{packages:["corechart","controls"]}),google.setOnLoadCallback(e);var m="https://query.yahooapis.com/v1/public/yql?q={0}&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",D="select * from {0} where {1}",v=500,b=!1;window.dscBuildChart=a,t(window).resize(function(){e()}),String.format=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,a){return"undefined"!=typeof e[a]?e[a]:t})},Date.prototype.format=function(t){for(var e="",a=Date.replaceChars,r=0;r<t.length;r++){var n=t.charAt(r);r-1>=0&&"\\"==t.charAt(r-1)?e+=n:a[n]?e+=a[n].call(this):"\\"!=n&&(e+=n)}return e},Date.replaceChars={shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return Date.replaceChars.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.replaceChars.longDays[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return this.getDate()%10==1&&11!=this.getDate()?"st":this.getDate()%10==2&&12!=this.getDate()?"nd":this.getDate()%10==3&&13!=this.getDate()?"rd":"th"},w:function(){return this.getDay()},z:function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil((this-t)/864e5)},W:function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil(((this-t)/864e5+t.getDay()+1)/7)},F:function(){return Date.replaceChars.longMonths[this.getMonth()]},m:function(){return(this.getMonth()<9?"0":"")+(this.getMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),0).getDate()},L:function(){var t=this.getFullYear();return t%400==0||t%100!=0&&t%4==0},o:function(){var t=new Date(this.valueOf());return t.setDate(t.getDate()-(this.getDay()+6)%7+3),t.getFullYear()},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return Math.floor(1e3*((this.getUTCHours()+1)%24+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)/24)},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?"0":"")+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},u:function(){var t=this.getMilliseconds();return(10>t?"00":100>t?"0":"")+t},e:function(){return"Not Yet Supported"},I:function(){for(var t=null,e=0;12>e;++e){var a=new Date(this.getFullYear(),e,1),r=a.getTimezoneOffset();if(null===t)t=r;else{if(t>r){t=r;break}if(r>t)break}}return this.getTimezoneOffset()==t|0},O:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},P:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+":00"},T:function(){var t=this.getMonth();this.setMonth(0);var e=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return this.setMonth(t),e},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return this.format("Y-m-d\\TH:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1e3}}}(jQuery);